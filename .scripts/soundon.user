#!/bin/sh
# $ID: /usr/lib/oss/soundon.user, 2012/02/13 -tclover Exp $
modprobe -a oss_{cmi878x,hdaudio,imux,userdev}
/usr/sbin/ossdetect -diu
/usr/sbin/ossdevlinks 
# Remapping ossdevlinks links
if [ -n "$(lsmod | grep oss_cmi878x)" ]; then
ln -sf /dev/oss/oss_cmi878x0/pcm1 /dev/dsp
ln -sf /dev/oss/oss_cmi878x0/pcm1 /dev/dsp_ac3
ln -sf /dev/oss/oss_cmi878x0/pcm1 /dev/dsp_in
ln -sf /dev/oss/oss_cmi878x0/pcm1 /dev/dsp_mmap
ln -sf /dev/oss/oss_cmi878x0/pcm1 /dev/dsp_multich
ln -sf /dev/oss/oss_cmi878x0/pcm1 /dev/dsp_out
/usr/sbin/vmixctl attach /dev/oss/oss_cmi878x0/pcm1 /dev/oss/oss_cmi878x0/pcm1
else
ln -sf /dev/oss/oss_hdaudio0/pcm0 /dev/dsp
ln -sf /dev/oss/oss_hdaudio0/pcmin0 /dev/dsp_in
#ln -sf /dev/oss/oss_hdaudio0/spdout0 /dev/dsp
ln -sf /dev/oss/oss_hdaudio0/spdout0 /dev/dsp_ac3
#ln -sf /dev/oss/oss_hdaudio0/spdin0 /dev/dsp_in
ln -sf /dev/oss/oss_hdaudio0/spdout0 /dev/dsp_mmap
ln -sf /dev/oss/oss_hdaudio0/spdout0 /dev/dsp_multich
ln -sf /dev/oss/oss_hdaudio0/spdout0 /dev/dsp_out
/usr/sbin/vmixctl attach /dev/oss/oss_hdaudio0/pcm0 /dev/oss/oss_hdaudio0/pcmin0
fi
exit 0
# vim:fenc=utf-8:ft=sh:ci:pi:sts=0:sw=2:ts=2:
